@using Food_Delivery.Models
@model List<FoodList>
@{
    ViewData["Title"] = "GetAllFood";
}
<div id="errormsg"   ></div>
<div class="container-fluid " id="container1" style="" >
    <div class="row row-cols-4 row-cols-sm-4 row-cols-md-4 row-cols-lg-4">

        @foreach (FoodList item in Model)
        {

            <div class="card me-4 mt-4  basket"  id="card">

                <img id="img" style=" width: 280px;border-radius:6%; height: 180px;margin-left:10%;margin-top:5%;margin-bottom:5%" src="/css/Image/@item.ImageId" multiple />

                @*  <p>HotelId:@item.HotelId</p>*@
                <div class="row col-md-12" style="font-weight: bold;">
                    <div class="col-md-7 offset-1"  > @item.FoodName </div>
                    <div class="col-md-4">   ₹ @item.Price  </div>
                </div>

                <div class="row ms-lg-3">
                   
                    <div>

                    <input type="text" id="Quantity" placeholder="Qty" name="fname">



                    <div class="col-md-4 offset-4  btn " id="addborder" onclick="Add(this, @item.FoodId,@item.HotelId,@item.Price,'@item.FoodName','@item.HotelName','@item.ImageId')">
                        Add <span class="bskt-icon mt-5" id="add1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-basket" viewBox="0 0 16 16">
                                <path d="M5.757 1.071a.5.5 0 0 1 .172.686L3.383 6h9.234L10.07 1.757a.5.5 0 1 1 .858-.514L13.783 6H15a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1v4.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 13.5V9a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h1.217L5.07 1.243a.5.5 0 0 1 .686-.172zM2 9v4.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V9H2zM1 7v1h14V7H1zm3 3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 4 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 6 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3A.5.5 0 0 1 8 10zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5zm2 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 1 .5-.5z" />
                            </svg>
                        </span>

                    </div>

                        <div style="text-align:center"><span> </span><span id="offer">50% off | Use WELCOME50</span></div>

                    </div>

                </div>

            </div>

        }

    </div>

</div>

@section Scripts{
    <link href="~/css/css style/userbyhotelid.css" rel="stylesheet" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script language="JavaScript" type="text/javascript">

        function Add(ele, HotelId, FoodId, Price,FoodName,HotelName,ImageId) {
           
                var qty=$(ele).parent("div").find("#Quantity").val();

            if (qty == null || qty == 0) {
                $('#errormsg').html("Please add Minimum Quantity of 1 ");
                return;
            }
                const obj = { hotelId: HotelId, foodId: FoodId,price: Price, quantity: qty,foodname:FoodName,hotelname:HotelName,imageid:ImageId }     
               
                console.log(qty);
                console.log(obj);
                const existing = localStorage.getItem('cart') ;

                const list = JSON.parse(existing) || [];
                var index = list.findIndex(x => x.foodId === FoodId && x.hotelId === HotelId);


            if (index == -1) {
                list.push(obj);
                var qty = $(ele).parent("div").find("#Quantity").val('0');
            }
            else {
                list[index].quantity = qty;
                var qty = $(ele).parent("div").find("#Quantity").val('0');


            }
            localStorage.setItem('cart', JSON.stringify(list));
            alert("food is added succesfully");
           
        }
    </script>
}